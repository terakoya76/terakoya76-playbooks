---
- name: Install uv
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.shell:
    cmd: |
      set -o pipefail
      set -e
      curl -LsSf https://astral.sh/uv/install.sh | sh
  changed_when: false
  tags:
    - config-tool

- name: Download xpanes
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.get_url:
    url: https://raw.githubusercontent.com/greymd/tmux-xpanes/v4.1.1/bin/xpanes
    dest: /tmp/xpanes
    mode: "0755"
  tags:
    - config-tool

- name: Install xpanes
  become: true
  ansible.builtin.command: install -m 0755 /tmp/xpanes /usr/local/bin/xpanes
  changed_when: false
  tags:
    - config-tool

# - name: Fetch Solarized Color Schema
#   become: true
#   become_user: "{{ ansible_user }}"
# shell: git clone https://github.com/tomislav/osx-terminal.app-colors-solarized solarized.git
# NOTE: check iceberg terminal theme when you're using MacOS
#   https://cocopon.github.io/iceberg.vim/

- name: Install powerline-shell
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.pip:
    name: powerline-shell
    state: present
    executable: pip3
  tags:
    - config-tool

- name: Install via cargo
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.command: bash -lc "cargo install {{ item }}"
  with_items:
    - alacritty
    - bat
    - cargo-generate
    - exa
    - fd-find
    - git-delta
    - neovide
    - onefetch
    - ripgrep
    - tokei
    - xsv
  environment:
    CARGO_NET_GIT_FETCH_WITH_CLI: "true"
  changed_when: false
  tags:
    - config-tool

- name: Place go-bin.sh
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.template:
    src: files/go-bin.sh
    dest: "{{ tools_ansible_home }}/.bash.d/go-bin.sh"
    mode: "0755"
  tags:
    - config-tool

- name: Install via golang
  become: true
  become_user: "{{ ansible_user }}"
  ansible.builtin.command: bash -lc "go install {{ item }}"
  with_items:
    - github.com/air-verse/air@latest
    - github.com/github/hub@latest
    - github.com/golang/protobuf/protoc-gen-go@latest
    - github.com/golangci/golangci-lint/cmd/golangci-lint@latest
    - github.com/go-delve/delve/cmd/dlv@latest
    - github.com/ktr0731/evans@latest
    - github.com/plumber-cd/terraform-backend-git@latest
    - github.com/pseudomuto/protoc-gen-doc/cmd/protoc-gen-doc@latest
    - github.com/spf13/cobra-cli@latest
    - github.com/terraform-docs/terraform-docs@latest
    - github.com/x-motemen/ghq@latest
    - honnef.co/go/tools/cmd/...@latest
  environment:
    GOPATH: "{{ tools_ansible_home }}/go"
  changed_when: false
  tags:
    - config-tool
